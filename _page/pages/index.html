{% extends layoutSourceDir + "/layout_with_sidebar.html" %}
{% block head %}
   <title>Kitchen Duty Plugin for Atlassian JIRA® by comSysto</title>
   <meta description="An interactive step-by-step tutorial on how to write Plugins for Atlassian JIRA® by comSysto">
{% endblock %}
{% block content %}




<div id="toc"></div>

<div class="cs-header">
    <div class="container cs-header__inner-container">
        <div class="row">
            <div class="col-md-6 cs-product-logo">
                <img src="./images/kitchen-duty-logo.svg">
                <h1 class="cs-hidden">Kitchen Duty Plugin for Atlassian JIRA® by comSysto</h1>
            </div>
            <div class="col-md-6  cs-header__corporate-logo hidden-xs hidden-sm">
                <a href="https://github.com/comsysto"><img src="./images/comsysto-logo.png" alt="comSysto"/></a>
            </div>
        </div>
    </div>
</div>

<div class="container  cs-content">
    <div class="row">
        <div class="col-md-12">

            <h2 class="cs-headline cs-headline--m">Introduction</h2>

            <p>This tutorial will show you <strong>how to write a simple Plugin for Atlassian JIRA®</strong>. The tutorial will focus on JIRA® 7.0 and will guide you step by step.</p>

            <p class="cs-notice-in-progress">NOTE: This document is work in progress. Once finished this notice is removed and the tutorial will be usable.</p>

        </div>
    </div>
    <div class="row">
        <div class="col-md-9">

            <h3 class="cs-headline cs-headline--s">Which Problem should the plugin solve?</h3>

            <p>You probably use Atlassian JIRA already to master your agile projects with Scrum and Kanban.</p>

            <p>But one thing is running out of hand in every office. <strong>The kitchen duty</strong> often lacks control and planning.</p>

            <p><strong>Why is the dish-washer full of dirty dishes but not turned on? Why are there no clean dishes?</strong></p>

            <p>These are the things we want to solve with our JIRA Plugin.</p>



            <h3 class="cs-headline cs-headline--s">Desired Features</h3>

            <p>Alright. The plugin should provide the following features.</p>

            <ol class="cs-list">
                <li class="cs-list__item">Page for Kitchen Duty planning
                    <ul class="cs-list">
                        <li class="cs-list__item">Setting of JIRA users for this weeks kitchen duty.</li>
                        <li class="cs-list__item">The page is only accessible for JIRA administrators.</li>
                    </ul>
                </li>
                <li class="cs-list__item">Overview Page for Kitchen Duty
                    <ul class="cs-list">
                        <li class="cs-list__item">Display of JIRA users who have kitchen duty this week.</li>
                        <li class="cs-list__item">The page should be accessible for all users and via the top navigation</li>
                    </ul>
                </li>
            </ol>
        </div>
        <div class="col-md-3 cs-meme-container">
            <img src="./images/memes/please-dishwasher.png" class="img-responsive">
        </div>
    </div>




    <div class="row">
        <div class="col-md-12">



            <h2 class="cs-headline cs-headline--m">Getting Started</h2>

            <p>That sounds like some simple features to implement so let's get to it.</p>

            <p>First install the <a href="https://developer.atlassian.com/docs/getting-started/set-up-the-atlassian-plugin-sdk-and-build-a-project">Atlassian SDK</a> and <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Oracle Java JDK 8</a> on your system.</p>

            <p>After the installation all the <code>atlas-*</code> commands and <code>java</code> command should be on the <code>PATH</code> variable.</p>

            <p>Let's do a <strong>short version check</strong> of the installed <strong>Atlassian SDK tools</strong>. I am using a Mac so the output will look a little different if you use another OS.</p>

<div class="cs-shell">
atlas-version<br><pre class="cs-shell-output">
ATLAS Version:    6.1.0
ATLAS Home:       /Applications/Atlassian/atlassian-plugin-sdk-6.1.0
ATLAS Scripts:    /Applications/Atlassian/atlassian-plugin-sdk-6.1.0/bin
ATLAS Maven Home: /Applications/Atlassian/atlassian-plugin-sdk-6.1.0/apache-maven-3.2.1
AMPS Version:     6.1.2
--------
Executing: /Applications/Atlassian/atlassian-plugin-sdk-6.1.0/apache-maven-3.2.1/bin/mvn --version -gs /Applications/Atlassian/atlassian-plugin-sdk-6.1.0/apache-maven-3.2.1/conf/settings.xml
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=256M; support was removed in 8.0
Apache Maven 3.2.1 (ea8b2b07643dbb1b84b6d16e1f08391b666bc1e9; 2014-02-14T18:37:52+01:00)
Maven home: /Applications/Atlassian/atlassian-plugin-sdk-6.1.0/apache-maven-3.2.1
Java version: 1.8.0_45, vendor: Oracle Corporation
Java home: /Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/jre
Default locale: de_DE, platform encoding: UTF-8
OS name: "mac os x", version: "10.10.5", arch: "x86_64", family: "mac"
</pre>
</div><!--cs-shell-->

            <p>Now check if <strong>Java is correctly installed</strong>.</p>

<div class="cs-shell">
java -version<br><pre class="cs-shell-output">
java version "1.8.0_45"
Java(TM) SE Runtime Environment (build 1.8.0_45-b14)
Java HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)
</pre>
</div><!--cs-shell-->

            <p>Ok once you got all that set-up we can start.</p>


        </div>
    </div>
    <div class="row">
        <div class="col-md-8">


            <h2 class="cs-headline cs-headline--m">Step 0: Creating the Plugin Project</h2>

            <p>We will now create the JIRA Plugin via the <a href="https://developer.atlassian.com/docs/developer-tools/working-with-the-sdk/command-reference/atlas-create-jira-plugin">Atlassian SDK command <code>atlas-create-jira-plugin</code></a>. Change to a folder where you want to create your Plugin.</p>
            <p>You will be asked to specify a <code>groupId</code>, <code>artifactId</code>, <code>version</code> and <code>package</code>. You can see my choices below.</p>

<div class="cs-shell">
atlas-create-jira-plugin<br><pre class="cs-shell-output">
...
Define value for groupId: : com.comsysto
Define value for artifactId: : kitchen-duty-plugin
Define value for version:  1.0.0-SNAPSHOT: :
Define value for package:  com.comsysto: : com.comsysto.kitchen.duty
....
Confirm
Y
...
</pre>
</div><!--cs-shell-->

            <p>Now the command should have created a folder called like the <code>artifactId</code>, in our case <code>kitchen-duty-plugin</code>.</p>

        </div>
        <div class="col-md-4">

            <div class="cs-sidenote">
                <div class="cs-sidenote__headline">
                    How do JIRA Plugins work?
                </div>
                <div class="cs-sidenote__content">
                    <div class="cs-sidenote__content-item">
                        JIRA Plugins are <a href="https://de.wikipedia.org/wiki/OSGi">OSGi</a> modules.
                    </div>
                    <div class="cs-sidenote__content-item">
                        JIRA starts an OSGi Service Plattform during startup (e.g. <a href="http://felix.apache.org/">Apache felix</a>).
                    </div>
                    <div class="cs-sidenote__content-item">
                        By providing information in <code>atlassian-plugin.xml</code> and custom packaging via <code>atlas-package</code>
                        the SDK builds an OSGi Plugin module in form of a <code>jar</code> file.
                    </div>
                    <div class="cs-sidenote__content-item">
                        JIRA Plugins can therefore be installed into a running JIRA instance. Once installed they are executed on JIRA startup too.
                    </div>
                </div>
            </div>

        </div>
    </div>






    <div class="row">
        <div class="col-md-12">


            <h3 class="cs-headline cs-headline--s"> Open Project in Java IDE</h3>

            <p>Use your favorite Java IDE to open the project. I use <a href="https://www.jetbrains.com/idea/">JetBrains IntelliJ IDEA</a> since it is just awesome. If you want to use Eclipse it is fine with me but all the screenshots will be done with IntelliJ.</p>

            <p>Once you have it opened we need to create 3 files for better usage with git and to tell the IDE how we want our indentation.</p>

            <p>Create <code>.editorconfig</code> and add statements for line endings, charset and tab indentation. Since IntelliJ is awesome <a href="http://EditorConfig.org">EditorConfig Plugin</a> is already installed. If you are using another IDE get the plugin now.</p>

<pre>
# EditorConfig is awesome: http://EditorConfig.org
root = true
[*]
end_of_line = lf
insert_final_newline = true
charset = utf-8

[*.html]
indent_style = space
indent_size = 4

[*.js]
indent_style = space
indent_size = 4

[*.css]
indent_style = space
indent_size = 4

[*.xml]
indent_style = space
indent_size = 4

[*.java]
indent_style = space
indent_size = 4

[*.vm]
indent_style = space
indent_size = 4
</pre>


            <p>Create <code>.gitignore</code> and add ignore statements for files we do not want to commit.</p>

<pre>
.idea/
*.iml
*.log
target/
</pre>

            <p>Create <code>.gitattributes</code> and set line endings to unix.</p>

<pre>
*.svg eol=lf
*.html eol=lf
*.js eol=lf
*.css eol=lf
*.scss eol=lf
*.json eol=lf
*.sh eol=lf
*.yml eol=lf
*.md eol=lf
*.txt eol=lf
*.java eol=lf
*.properties  eol=lf
*.xml eol=lf
</pre>


            <div class="cs-v-spacer cs-v-spacer--big"></div>


            <div class="alert alert-warning cs-warning" role="alert">
                <i class="fa fa-exclamation-triangle fa-lg cs-warning__icon"></i>
                The created base project has some minor flaws and some things are still missing before it can actually be build.
            </div>


            <p>Edit <code>pom.xml</code> and add line <code>&lt;version&gt;3.3&lt;/version&gt;</code> to <code>maven-compiler-plugin</code>.</p>

<pre>
&lt;plugin&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;3.3&lt;/version&gt;
    &lt;configuration&gt;
        &lt;source&gt;1.7&lt;/source&gt;
        &lt;target&gt;1.7&lt;/target&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre>

            <p>Also add in the <code>pom.xml</code> right before the closing <code>&lt;/dependencies&gt;</code>.</p>

<pre>
    &lt;dependency&gt;
        &lt;groupId&gt;com.atlassian.sal&lt;/groupId&gt;
        &lt;artifactId&gt;sal-api&lt;/artifactId&gt;
        &lt;version&gt;3.0.3&lt;/version&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre>


            <p>Now open <strong>Preferences</strong> in IntelliJ and set the built-in maven of the SDK together with the <code>settings.xml</code></p>
            <p>(Tip: By calling <code>atlas-version</code> all paths including home directory of SDK are printed)</p>

            <p><img src="./images/doc/step-00-intellij-maven-install-settings.png" class="img-responsive" alt="Set maven home and maven settings.xml"></p>

            <div class="cs-v-spacer"></div>

            <p>Since we need the <code>ATLAS_HOME</code> environment variable to get maven inside IntelliJ to work we set that as well.</p>

            <p><img src="./images/doc/step-00-intellij-maven-atlas-home.png" class="img-responsive" alt="Set ATLAS_HOME"></p>

            <div class="cs-v-spacer"></div>

            <p>Now you can click on the <strong>Maven-Tab</strong> on the right and click <strong>compile</strong> and you should have a successful build.</p>

            <p><img src="./images/doc/step-00-intellij-maven-successful-compile.png" class="img-responsive" alt="Successful Maven Compile"></p>

            <div class="cs-v-spacer"></div>

            <p>If you do a <strong>Build</strong> &gt; <strong>Make Project</strong> now and open the <code>MyPluginComponentImpl.java</code> you should have no errors.</p>

            <div class="cs-v-spacer"></div>

            <div class="cs-tutorial-step-review">
                <div class="cs-tutorial-step-review__headline">
                    <strong>You have completed Step 0.</strong> Good Job! You can check out this steps solution on GitHub
                </div>
                <div class="cs-tutorial-step-review__link">
                    <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-00-kitchen-duty-plugin">
                        https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-00-kitchen-duty-plugin
                    </a>
                </div>
            </div>

            <div class="cs-v-spacer cs-v-spacer--big"></div>






            <h2 class="cs-headline cs-headline--m">Step 1: Kitchen Duty planning Page </h2>

            <p>Our base project is there and ...</p>



            <p class="cs-notice-in-progress">to be done.</p>





        </div>
    </div>

    <div class="row">
        <div class="col-md-12 cs-license-container">

            <hr class="cs-divider">

            <strong>License and Author</strong>
            <p>
              The project sources are free for personal and commercial use under the terms of the <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported (CC BY 3.0) License</a>.
              The author is <a href="http://comsysto.com/">comSysto GmbH</a>. The <a href="https://thenounproject.com/term/dishwasher/29752/">dishes icon</a> in the logo is licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 (CC BY 3.0 US) License</a></p>

            <hr class="cs-divider">
            <strong><a href="http://comsysto.com/imprint.html">Impressum</a></strong> ~ <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira">View project on GitHub</a>

            <div class="cs-v-spacer"></div>

        </div>
    </div>
</div>


{% endblock %}
