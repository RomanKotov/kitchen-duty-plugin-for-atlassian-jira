<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    
   <title>Kitchen Duty Plugin for Atlassian JIRA® by comSysto</title>
   <meta description="An interactive step-by-step tutorial on how to write Plugins for Atlassian JIRA® by comSysto">



    <link href="./generated/bundle.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Menlo|Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>

    <link rel="icon" href="./images/favicon-32.png" type="image/png" sizes="32x32">
    <link rel="icon" href="./images/favicon-256.png" type="image/png" sizes="256x256">
    <link rel="icon" href="./images/favicon.svg" type="image/svg+xml">

    <script>var postLoadMethods = [];</script>
</head>
<body>
<!-- MACROS START -->










<!-- MACROS END -->




<!-- CONTENT -->







<div class="container-fluid cs-header">
    <div class="row">
        <div class="col-md-6 cs-product-logo">
            <img src="./images/kitchen-duty-logo.svg">
            <h1 class="cs-hidden">Kitchen Duty Plugin for Atlassian JIRA® by comSysto</h1>
        </div>
        <div class="col-md-6  cs-header__corporate-logo hidden-xs hidden-sm">
            <a href="https://github.com/comsysto"><img src="./images/comsysto-logo.png" alt="comSysto"/></a>
        </div>
    </div>
</div>

<div class="container-fluid cs-content">
    <div class="row">
        <div class="col-md-3 hidden-sm hidden-xs" id="toc">
            <ul>
                
                <li class="toc-h2">
    
    <a data-scroll-to="introduction">Introduction</a>
</li>
                
                <li class="toc-h2">
    
    <a data-scroll-to="getting-started">Getting Started</a>
</li>

                
                <li class="toc-h2"><span class="badge pull-right">Step 0</span> 
    
    <a data-scroll-to="creating-the-plugin-project">Creating the Plugin Project</a>
</li>



                <li class="toc-h2-divider">Kitchen Duty Planning Page</li>

                
                <li class="toc-h2">
    
    <a data-scroll-to="story-workshop-for-planning-page">Story Workshop for Planning Page</a>
</li>

                
                <li class="toc-h2"><span class="badge pull-right">Step 1</span> 
    
    <a data-scroll-to="webwork-action-and-html-view">Webwork Action and HTML View</a>
</li>

                
                <li class="toc-h2"><span class="badge pull-right">Step 2</span> 
    
    <a data-scroll-to="user-rest-resource-and-js-controller">User REST Resource and JS Controller</a>
</li>

            </ul>
        </div>
        <div class="col-md-9 col-md-offset-3">
            <div class="row">
                <div class="col-md-12">





                    
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="introduction"
        data-scroll-to-headline-previous="">
        
        Introduction
    </h2>


                    <p>
                        This tutorial will show you <strong>how to write a simple Plugin for <a href="https://www.atlassian.com/software/jira">Atlassian JIRA®</a></strong>.
                        The tutorial will focus on JIRA® 7.0 and will guide you step by step.
                        Note that we are developing a <strong>JIRA Plugin for Hosted JIRA instances only</strong>.
                        If you are interessted in developing Plugins for JIRA Cloud you might want to check out <a href="https://developer.atlassian.com/static/connect/docs/latest/index.html">Atlassian Connect</a>.

                    </p>

                    <p><strong>Intended Audience</strong> - This tutorial implies that you already have knowledge about <a href="https://en.wikipedia.org/wiki/Java_Platform,_Enterprise_Edition">JavaEE software development</a> with <a href="https://maven.apache.org/">Apache Maven</a> at best with <a href="https://www.jetbrains.com/idea/">JetBrains IntelliJ IDEA</a>.
                    You will need no prior knowledge about JIRA development. But you should at least know what JIRA is and that it has a Plugin system to install external plugins.
                    </p>

                    <div class="alert alert-warning cs-warning" role="alert">
                        <i class="fa fa-exclamation-triangle fa-lg cs-warning__icon"></i>
                        <strong>This document is work in progress.</strong> It will steadily grow as time passes by. So it is up to you waiting for it to be completely finished, or if you want early-access.
                        You can give us <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/issues">feedback via the Issue Tracker</a>.
                    </div>

                </div>
            </div>
            <div class="row">
                <div class="col-md-9">

                    <h3 class="cs-headline cs-headline--s">Which Problem should the plugin solve?</h3>

                    <p>You probably use Atlassian JIRA already to master your agile projects with Scrum and Kanban.</p>

                    <p>But one thing is running out of hand in every office. <strong>The kitchen duty</strong> often lacks control and planning.</p>

                    <p><strong>Why is the dish-washer full of dirty dishes but not turned on? Why are there no clean dishes?</strong></p>

                    <p>These are the things we want to solve with our JIRA Plugin.</p>



                    <h3 class="cs-headline cs-headline--s">Desired Features as User Stories</h3>

                    <p>Since we know the problem now combinded with beeing master developers we came up pretty fast with some kick-ass mockups.
                        That led us to the following user stories with acceptance criteria.</p>

                    <div class="row">
                        <div class="col-md-6">
                            <p><span class="cs-special">Kitchen Duty Planning Page</span></p>
                            <a href="./images/drawings/00-mock-kitchen-duty-planning-page_big.jpg" data-lightbox="user-stories" data-title="Kitchen Duty Planning Page Mockup">
                                <img src="./images/drawings/00-mock-kitchen-duty-planning-page.jpg" class="img-responsive cs-image" alt="Kitchen Duty Planning Page Mockup">
                            </a>

                            <p><strong>User Story</strong></p>
                            <p>As office-boss I want to assign people for kitchen duty on a weekly basis to improve the kitchens tidiness.</p>
                            <p><strong>Acceptance Criteria</strong></p>
                            <ul class="cs-list">
                                <li class="cs-list__item">Setting one or more JIRA users for selected week's kitchen duty.</li>
                                <li class="cs-list__item">The page is only accessible for JIRA administrators.</li>
                            </ul>


                        </div>
                        <div class="col-md-6">
                            <p><span class="cs-special">Kitchen Duty Overview Page</span></p>
                            <a href="./images/drawings/00-mock-kitchen-duty-overview-page_big.jpg" data-lightbox="user-stories" data-title="Kitchen Duty Overview Page Mockup">
                                <img src="./images/drawings/00-mock-kitchen-duty-overview-page.jpg" class="img-responsive cs-image" alt="Kitchen Duty Overview Page Mockup">
                            </a>
                            <p><strong>User Story</strong></p>
                            <p>As office-knave I want to see who is scheduled for this weeks kitchen duty to improve obedience.</p>
                            <p><strong>Acceptance Criteria</strong></p>
                            <ul class="cs-list">
                                <li class="cs-list__item">Display of JIRA users who have kitchen duty this week.</li>
                                <li class="cs-list__item">Show whole month in a calendar which is clickable to see future months.</li>
                                <li class="cs-list__item">The page should be accessible for all authenticated users.</li>
                                <li class="cs-list__item">The page should have a navigation entry in the top navigation.</li>
                                <li class="cs-list__item">(Stretch Goal: Add Button "when do I have kitchen duty" to jump to the month and week in the calender when the logged in JIRA user is scheduled for kitchen duty).</li>
                            </ul>

                        </div>
                    </div>
                </div>
                <div class="col-md-3 cs-meme-container hidden-xs hidden-sm">
                    <img src="./images/drawings/sponge_small.jpg" class="img-responsive">
                </div>
            </div>




            <div class="row">
                <div class="col-md-12">






                    
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="getting-started"
        data-scroll-to-headline-previous="introduction">
        
        Getting Started
    </h2>


                    <p>That sounds like some simple features to implement so let's get to it.</p>

                    <p>First install the <a href="https://developer.atlassian.com/docs/getting-started/set-up-the-atlassian-plugin-sdk-and-build-a-project">Atlassian SDK</a> and <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Oracle Java JDK 8</a> on your system.</p>

                    <p>After the installation all the <code>atlas-*</code> commands and <code>java</code> command should be on the <code>PATH</code> variable.</p>

                    <p>Let's do a <strong>short version check</strong> of the installed <strong>Atlassian SDK tools</strong>. I am using a Mac so the output will look a little different if you use another OS.</p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        atlas-version<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">ATLAS Version:    <span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>
ATLAS Home:       /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>
ATLAS Scripts:    /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/bin
ATLAS Maven Home: /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>
AMPS Version:     <span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>
--------
Executing: /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>/bin/mvn --version -gs /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>/conf/settings.xml
Java HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM warning: ignoring option MaxPermSize=<span class="hljs-number">256</span>M; support was removed <span class="hljs-keyword">in</span> <span class="hljs-number">8.0</span>
Apache Maven <span class="hljs-number">3.2</span>.<span class="hljs-number">1</span> (ea8b2b07643dbb1b84b6d16e1f08391b666bc1e9; <span class="hljs-number">2014</span>-<span class="hljs-number">02</span>-<span class="hljs-number">14</span>T18:<span class="hljs-number">37</span>:<span class="hljs-number">52</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>)
Maven home: /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>
Java version: <span class="hljs-number">1.8</span>.<span class="hljs-number">0</span>_45, vendor: Oracle Corporation
Java home: /Library/Java/JavaVirtualMachines/jdk1.<span class="hljs-number">8.0</span>_45.jdk/Contents/Home/jre
Default locale: de_DE, platform encoding: UTF-<span class="hljs-number">8</span>
OS name: <span class="hljs-string">"mac os x"</span>, version: <span class="hljs-string">"10.10.5"</span>, arch: <span class="hljs-string">"x86_64"</span>, family: <span class="hljs-string">"mac"</span></code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="atlas-version"><i class="fa fa-files-o"></i></a>
</div>


                    <p>Now check if <strong>Java is correctly installed</strong>.</p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        java -version<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">java version <span class="hljs-string">"1.8.0_45"</span>
Java(TM) SE Runtime Environment (build <span class="hljs-number">1.8</span>.<span class="hljs-number">0</span>_45-b14)
Java HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM (build <span class="hljs-number">25.45</span>-b02, mixed mode)</code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="java -version"><i class="fa fa-files-o"></i></a>
</div>


                    <p>Ok once you got all that set-up we can start.</p>



                </div>
            </div>
            <div class="row">
                <div class="col-md-8">





                    
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="creating-the-plugin-project"
        data-scroll-to-headline-previous="getting-started">
        
        Creating the Plugin Project
    </h2>


                    <p>We will now create the JIRA Plugin via the <a href="https://developer.atlassian.com/docs/developer-tools/working-with-the-sdk/command-reference/atlas-create-jira-plugin">Atlassian SDK command <code>atlas-create-jira-plugin</code></a>. Change to a folder where you want to create your Plugin.</p>
                    <p>You will be asked to specify a <code>groupId</code>, <code>artifactId</code>, <code>version</code> and <code>package</code>. You can see my choices below.</p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        atlas-create-jira-plugin<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">...
Define value <span class="hljs-keyword">for</span> groupId: : com.comsysto
Define value <span class="hljs-keyword">for</span> artifactId: : kitchen-duty-plugin
Define value <span class="hljs-keyword">for</span> version:  <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>-SNAPSHOT: :
Define value <span class="hljs-keyword">for</span> package:  com.comsysto: : com.comsysto.kitchen.duty
....
Confirm
Y
...</code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="atlas-create-jira-plugin"><i class="fa fa-files-o"></i></a>
</div>



                    <p>Now the command should have created a folder called like the <code>artifactId</code>, in our case <code>kitchen-duty-plugin</code>.</p>

                </div>
                <div class="col-md-4">

                    <div class="cs-sidenote">
                        <div class="cs-sidenote__headline">
                            How do JIRA Plugins work?
                        </div>
                        <div class="cs-sidenote__content">
                            <div class="cs-sidenote__content-item">
                                JIRA Plugins are <a href="https://de.wikipedia.org/wiki/OSGi">OSGi</a> bundles.
                            </div>
                            <div class="cs-sidenote__content-item">
                                JIRA starts an OSGi Service Plattform during startup (e.g. <a href="http://felix.apache.org/">Apache felix</a>).
                            </div>
                            <div class="cs-sidenote__content-item">
                                By providing information in <code>pom.xml</code> and custom packaging via <code>atlas-package</code>
                                the SDK builds an OSGi Plugin bundle in form of a <code>jar</code> file.
                            </div>
                            <div class="cs-sidenote__content-item">
                                JIRA Plugins can therefore be installed into a running JIRA instance. Once installed they are executed on JIRA startup too.
                            </div>
                        </div>
                    </div>

                </div>
            </div>






            <div class="row">
                <div class="col-md-12">


                    <h3 class="cs-headline cs-headline--s"> Open Project in Java IDE</h3>

                    <p>Use your favorite Java IDE to open the project. I use <a href="https://www.jetbrains.com/idea/">JetBrains IntelliJ IDEA</a> since it is just awesome. If you want to use Eclipse it is fine with me but all the screenshots will be done with IntelliJ.</p>

                    <p>Once you have it opened we need to create 3 files for better usage with git and to tell the IDE how we want our indentation.</p>

                    <p>Create <code>.editorconfig</code> and add statements for line endings, charset and tab indentation. Since IntelliJ is awesome <a href="http://EditorConfig.org">EditorConfig Plugin</a> is already installed. If you are using another IDE get the plugin now.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-comment"># EditorConfig is awesome: http://EditorConfig.org</span>
<span class="hljs-setting">root = <span class="hljs-value"><span class="hljs-keyword">true</span></span></span>
<span class="hljs-title">[*]</span>
<span class="hljs-setting">end_of_line = <span class="hljs-value">lf</span></span>
<span class="hljs-setting">insert_final_newline = <span class="hljs-value"><span class="hljs-keyword">true</span></span></span>
<span class="hljs-setting">charset = <span class="hljs-value">utf-<span class="hljs-number">8</span></span></span>
<span class="hljs-title">
[*.html]</span>
<span class="hljs-setting">indent_style = <span class="hljs-value">space</span></span>
<span class="hljs-setting">indent_size = <span class="hljs-value"><span class="hljs-number">4</span></span></span>
<span class="hljs-title">
[*.js]</span>
<span class="hljs-setting">indent_style = <span class="hljs-value">space</span></span>
<span class="hljs-setting">indent_size = <span class="hljs-value"><span class="hljs-number">4</span></span></span>
<span class="hljs-title">
[*.css]</span>
<span class="hljs-setting">indent_style = <span class="hljs-value">space</span></span>
<span class="hljs-setting">indent_size = <span class="hljs-value"><span class="hljs-number">4</span></span></span>
<span class="hljs-title">
[*.xml]</span>
<span class="hljs-setting">indent_style = <span class="hljs-value">space</span></span>
<span class="hljs-setting">indent_size = <span class="hljs-value"><span class="hljs-number">4</span></span></span>
<span class="hljs-title">
[*.java]</span>
<span class="hljs-setting">indent_style = <span class="hljs-value">space</span></span>
<span class="hljs-setting">indent_size = <span class="hljs-value"><span class="hljs-number">4</span></span></span>
<span class="hljs-title">
[*.vm]</span>
<span class="hljs-setting">indent_style = <span class="hljs-value">space</span></span>
<span class="hljs-setting">indent_size = <span class="hljs-value"><span class="hljs-number">4</span></span></span></code></pre>


                    <p>Create <code>.gitignore</code> and add ignore statements for files we do not want to commit.</p>

                    
<pre class="cs-code"><code class="hljs">.idea/
*.iml
*.log
target/</code></pre>


                    <p>Create <code>.gitattributes</code> and set line endings to unix.</p>

                    
<pre class="cs-code"><code class="hljs">*.svg eol=lf
*.html eol=lf
*.js eol=lf
*.css eol=lf
*.scss eol=lf
*.json eol=lf
*.sh eol=lf
*.yml eol=lf
*.md eol=lf
*.txt eol=lf
*.java eol=lf
*.properties  eol=lf
*.xml eol=lf</code></pre>


                    <div class="cs-v-spacer cs-v-spacer--big"></div>


                    <div class="alert alert-warning cs-warning" role="alert">
                        <i class="fa fa-exclamation-triangle fa-lg cs-warning__icon"></i>
                        The created base project has some minor flaws and some things are still missing before it can actually be build.
                    </div>


                    <p>Edit <code>pom.xml</code> and add line <code>&lt;version&gt;3.3&lt;/version&gt;</code> to <code>maven-compiler-plugin</code>.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>3.3<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">configuration</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">source</span>&gt;</span>1.7<span class="hljs-tag">&lt;/<span class="hljs-title">source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">target</span>&gt;</span>1.7<span class="hljs-tag">&lt;/<span class="hljs-title">target</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">configuration</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">plugin</span>&gt;</span></code></pre>


                    <p>Also add in the <code>pom.xml</code> right before the closing <code>&lt;/dependencies&gt;</code>.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">dependencies</span>&gt;</span>
   ...
   <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.atlassian.sal<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>sal-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>3.0.3<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependencies</span>&gt;</span></code></pre>


                    <p>Now open <strong>Preferences</strong> in IntelliJ and set the built-in maven of the SDK together with the <code>settings.xml</code></p>
                    <p>(Tip: By calling <code>atlas-version</code> all paths including home directory of SDK are printed)</p>

                    <p>
                        <a href="./images/doc/step-00-intellij-maven-install-settings.png" data-lightbox="00-step-intellij" data-title="Step 0 - Set maven home and maven settings.xml">
                            <img src="./images/doc/step-00-intellij-maven-install-settings.png" class="img-thumbnail img-responsive cs-tutorial-image" alt="Step 0 - Set maven home and maven settings.xml">
                        </a>
                    </p>

                    <div class="cs-v-spacer"></div>

                    <p>Since we need the <code>ATLAS_HOME</code> environment variable to get maven inside IntelliJ to work we set that as well.</p>

                    <p>
                        <a href="./images/doc/step-00-intellij-maven-atlas-home.png" data-lightbox="00-step-intellij" data-title="Step 0 - Set ATLAS_HOME variable">
                            <img src="./images/doc/step-00-intellij-maven-atlas-home.png" class="img-thumbnail img-responsive cs-tutorial-image" alt="Step 0 - Set ATLAS_HOME variable">
                        </a>
                    </p>

                    <div class="cs-v-spacer"></div>

                    <p>Now you can click on the <strong>Maven-Tab</strong> on the right and click <strong>compile</strong> and you should have a successful build.</p>

                    <p>
                        <a href="./images/doc/step-00-intellij-maven-successful-compile.png" data-lightbox="00-step-intellij" data-title="Step 0 - Successful Maven Compile">
                            <img src="./images/doc/step-00-intellij-maven-successful-compile.png" class="img-thumbnail img-responsive cs-tutorial-image" alt="Step 0 - Successful Maven Compile">
                        </a>
                    </p>

                    <div class="cs-v-spacer"></div>

                    <p>If you do a <strong>Build</strong> &gt; <strong>Make Project</strong> now and open the <code>MyPluginComponentImpl.java</code> you should have no errors.</p>

                    <div class="cs-v-spacer"></div>

                    <div class="cs-tutorial-step-review">
                        <div class="cs-tutorial-step-review__headline">
                            <strong>You have completed Step 0.</strong> Good Job! You can check out this steps solution on GitHub
                        </div>
                        <div class="cs-tutorial-step-review__link">
                            <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-00-kitchen-duty-plugin">
                                https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-00-kitchen-duty-plugin
                            </a>
                        </div>
                    </div>





                    <h3 class="cs-headline cs-headline--s">Further Reading: OSGi</h3>

                    <p>You can skip this chapter if you already know OSGi or if you are not interested in the deep internals of imports and exports beetween OSGi modules. The next Step of the tutorial will build on this knowledge.</p>

                    <p>As you opened <code>MyPluginComponentImpl.java</code> already you might have seen some annotations like <code>@ExportAsService</code> and <code>@ComponentImport</code>.</p>

                    <p>There is also an important passage of <code>maven-jira-plugin</code> in the <code>pom.xml</code> that contains the following lines.</p>

                    
<pre class="cs-code"><code class="hljs">...
<span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>maven-jira-plugin<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
...
<span class="hljs-tag">&lt;<span class="hljs-title">instructions</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Atlassian-Plugin-Key</span>&gt;</span>${atlassian.plugin.key}<span class="hljs-tag">&lt;/<span class="hljs-title">Atlassian-Plugin-Key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Export-Package</span>&gt;</span>
       com.comsysto.kitchen.duty.api,
    <span class="hljs-tag">&lt;/<span class="hljs-title">Export-Package</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Import-Package</span>&gt;</span>
       org.springframework.osgi.*;resolution:="optional",
       org.eclipse.gemini.blueprint.*;resolution:="optional",
       *
   <span class="hljs-tag">&lt;/<span class="hljs-title">Import-Package</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">Spring-Context</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-title">Spring-Context</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">instructions</span>&gt;</span></code></pre>


                    <p>
                        We will now dive into unterstanding what all that means.
                        First you should read the <a href="https://en.wikipedia.org/wiki/OSGi">Wikipedia Article on OSGi</a>.
                    </p>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Services (OSGi)</strong></p>

                            <p>
                                Each bundle can publish and find interfaces and therefore use functionality from other bundles.
                                JIRA itself is composed of some OSGi bundles itself. Therefore we need to tell the Atlassian SDK which JIRA interfaces we want to use (the OSGi framework then finds the right bundle for us automatically).
                            </p>

                            <p><strong>Life-Cycle (OSGi)</strong></p>

                            <p>We can install, start and stop OSGi bundles during runtime. That means, while JIRA is running our plugin can be installed, started and stopped.</p>


                            <p><strong>Bundles (OSGi)</strong></p>

                            <p>Bundles (also called modules) only share Interfaces with other modules. You want to hide your implementation. The Atlassian SDK creates a <code>jar</code> file with
                                a custom <code>MANIFEST.mf</code> from the <code>Import/Export-Package</code> instructions of <code>pom.xml</code> and the <a href="https://bitbucket.org/atlassian/atlassian-spring-scanner/overview">Atlassian Spring Scanner Annotations e.g. <code>@ComponentImport</code></a>.</p>

                        </div>
                        <div class="col-md-6">
                            <p>
                                <a href="./images/drawings/00-mock-osgi-and-jira_big.jpg" data-lightbox="00-osgi" data-title="OSGi and JIRA">
                                    <img src="./images/drawings/00-mock-osgi-and-jira.jpg" class="img-thumbnail img-responsive" alt="OSGi and JIRA">
                                </a>
                            </p>
                        </div>
                    </div>

                    <p>We run the package command, so that the jar file is build.</p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        atlas-package<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">...
[INFO] Building jar: /Users/../kitchen-duty-plugin/target/kitchen-duty-plugin-<span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>-SNAPSHOT.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------</code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="atlas-package"><i class="fa fa-files-o"></i></a>
</div>


                    <p>We can now inspect the <code>MANIFEST.mf</code> file (I have shortened it a little).</p>
                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        cat target/classes/MANIFEST.md<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">Manifest-Version: <span class="hljs-number">1.0</span>
Atlassian-Build-Date: <span class="hljs-number">2015</span>-<span class="hljs-number">12</span>-<span class="hljs-number">15</span>T18:<span class="hljs-number">43</span>:<span class="hljs-number">43</span>+<span class="hljs-number">0100</span>
Atlassian-Plugin-Key: com.comsysto.kitchen-duty-plugin
Bundle-Name: kitchen-duty-plugin
Bundle-SymbolicName: com.comsysto.kitchen-duty-plugin
Bundle-Vendor: comSysto
Bundle-Version: <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>.SNAPSHOT
Export-Package: com.comsysto.kitchen.duty.api;version=<span class="hljs-string">"1.0.0"</span>
Import-Package: org.springframework.osgi.service.exporter.support;resolution:=optional,
org.springframework.osgi.service.importer.support;resolution:=optional,
....
Require-Capability: osgi.ee;filter:=<span class="hljs-string">"(&amp;(osgi.ee=JavaSE)(version=1.7))"</span>
Spring-Context: *</code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="cat target/classes/MANIFEST.md"><i class="fa fa-files-o"></i></a>
</div>


                    <p>We see <code>Export-Package</code> and <code>Import-Package</code> statements with the values we expected from pom.xml and Annotations</p>

                    <div class="alert alert-info cs-summary">
                        <p class="cs-summary__headline"><i class="fa fa-lightbulb-o fa-lg"></i> Summary</p>
                        <hr class="cs-summary__spacer">
                        <p><strong>@ExportAsService</strong> is used to export our interface (e.g. <code>MyPluginComponent.java</code>) so that other OSGi bundles can use it as Spring Bean. Maybe you want to develop a base plugin and use its functionality from a second plugin, then you know now how to do it.</p>
                        <hr class="cs-summary__spacer">
                        <p><strong>@ComponentImport</strong> is used to import functionality from other OSGi bundles Spring Context such as JIRAs <code>ApplicationProperties</code>.</p>
                        <hr class="cs-summary__spacer">
                        <p>These annotations are used because JIRA uses <strong><a href="https://spring.io/">Spring</a> together with OSGi</strong> and these annotations help to make beans available as Spring Beans and to get them from the <strong>Spring Context</strong> (even if it is a spring context from other bundle).</p>
                        <hr class="cs-summary__spacer">
                        <p>If we want to do something low-level with OSGi imports and exports we can do that in the <strong>pom.xml</strong> with <code>&lt;Import-Package&gt;</code> and <code>&lt;Export-Package&gt;</code></p>
                    </div>




                    <p>
                        If you want to dive even deeper into OSGi and Atlassian read about <a href="https://bitbucket.org/atlassian/atlassian-spring-scanner/overview">Atlassian Spring Scanner</a>, watch the <a href="https://www.youtube.com/watch?v=BthwKfxATNE">Apache Felix Introduction Video</a>
                        or do the <a href="http://felix.apache.org/documentation/tutorials-examples-and-presentations/apache-felix-osgi-tutorial.html">Apache Felix Tutorials</a>.
                    </p>


                    <div class="cs-v-spacer cs-v-spacer--big"></div>







                    
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="story-workshop-for-planning-page"
        data-scroll-to-headline-previous="creating-the-plugin-project">
        
        Story Workshop for Planning Page
    </h2>


                </div>
            </div>
            <div class="row">
                <div class="col-md-8">

                    <p>Our base project is compiling and now we want to tackle our first User Story and <strong>implement the Kitchen Duty Planning page</strong>.
                    </p>

                    <p>But before we start the implementation we drink another coffee and get our brain up to software-architecture-design-speed, because we need to make some <strong>design decisions</strong> now.
                        Think of the following section as a little <strong>Story Workshop</strong> we do with our virtual Product Owner and the virtual Scrum Team.</p>


                    <h3 class="cs-headline cs-headline--s">What does the Planning Page really need to do? </h3>

                    <div class="row">
                        <div class="col-md-4">
                            <a href="./images/drawings/00-mock-kitchen-duty-planning-page_big.jpg" data-lightbox="user-stories" data-title="Kitchen Duty Planning Page Mockup">
                                <img src="./images/drawings/00-mock-kitchen-duty-planning-page.jpg" class="img-responsive cs-image" alt="Kitchen Duty Planning Page Mockup">
                            </a>
                        </div>
                        <div class="col-md-8">
                            <ul>
                                <li>We need to be able to get a list of all JIRA usernames and make them selectable.</li>
                                <li>We need some kind of calendar widget that is clickable and let's us select weeks.</li>
                                <li>We need to be able to persist the information permanently into some kind of database storage.</li>
                                <li>We need to be able to get stored users for a week, display and make them removable from the weeks schedule.</li>
                            </ul>

                            <p>
                                Ok sounds like basic stuff we did a trillion times already in some other projects.
                                But the question is, <strong>how do we do this the cool Atlassian way?</strong>
                            </p>
                        </div>
                    </div>




                </div>
                <div class="col-md-4 hidden-xs hidden-sm">
                    <img src="./images/drawings/serious-thinking.jpg" class="img-responsive">
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">

                    <h3 class="cs-headline cs-headline--s">UX Components (Atlassian AUI)</h3>

                    <div class="row">
                        <div class="col-md-8">
                            <p>
                                Most of you might know <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a> and use it to build sweet responsive websites.
                                Atlassian also has such a Framework that drives their Applications. It is called <strong><a href="https://docs.atlassian.com/aui/latest/"  target="_blank">Atlassian User Interface</a></strong> in short AUI.
                            </p>
                            <div class="col-md-offset-1 col-md-10">
                                <p>
                                    <a href="https://docs.atlassian.com/aui/latest/" target="_blank">
                                        <img src="./images/doc/step-01-atlassian-aui-screenshot.png" class="img-thumbnail img-responsive" alt="Atlassian User Interface Screenshot">
                                    </a>
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <p><strong>Shopping List</strong></p>
                            <ul>
                                <li>

                                    <p>
                                        <a href="https://docs.atlassian.com/aui/latest/docs/auiselect2.html" target="_blank">
                                            AUI Select 2 component for User Selection
                                        </a>
                                    </p>

                                    <p><img src="./images/doc/step-01-aui-select2-demo.gif"
                                            class="img-thumbnail img-responsive cs-tutorial-image"
                                            alt="AUI select2 demo"></p>
                                </li>
                                <li>
                                    <p>
                                        <a href="https://docs.atlassian.com/aui/latest/docs/date-picker.html" target="_blank">
                                            AUI Datepicker component for Week Selection
                                        </a>
                                    </p>
                                    <p><img src="./images/doc/step-01-aui-datepicker-demo.gif"
                                            class="img-thumbnail img-responsive cs-tutorial-image"
                                            alt="AUI select2 demo"></p>
                                </li>
                            </ul>


                        </div>
                    </div>


                    <p>Ok now we have <strong>selected the two frontend components</strong> we want to use and continue with <strong>server side components</strong>.</p>

                    <div class="cs-v-spacer cs-v-spacer--small"></div>


                    <div class="row">
                        <div class="col-md-5">

                            <h3 class="cs-headline cs-headline--s">Component Planning</h3>


                            <p>The caffeine kicks in now and our spacey software-engineering mind is fully operational to <strong>design the server components</strong>.</p>

                            <p>We could use a Servlet and simple MVC approach with lame JSP-style-pages and normal Request-Response-Cycle ...</p>

                            <p>But since that is just lame we will do it with <strong>REST Resources</strong> and a simple view that has a lot of (ugly) JavaScript code to interact with the REST Resources.</p>

                            <p>So after thinking about that a little we came up with the scheme on the right. (What is Webwork Action? We will learn about that soon.)</p>



                        </div>
                        <div class="col-md-5 col-md-offset-1 cs-tutorial-space-top-small">
                            <p>
                                <a href="./images/drawings/01-mock-server-side-component-design.jpg" data-lightbox="01-step-server-side" data-title="Step 1 - Server Side Component Design">
                                    <img src="./images/drawings/01-mock-server-side-component-design.jpg" class="img-thumbnail img-responsive" alt="Step 1 - Server Side Component Design">
                                </a>
                            </p>
                        </div>
                    </div>

                    <p><strong>Component Overview</strong></p>

                    <ul>
                        <li><p><strong>KitchenDutyPlanningWebworkAction</strong> is a basic &ldquo;Servlet&rdquo; that provides the actual Page to browse to and provides the HTML View and JavaScript.</p>
                            <ul>
                                <li><p><strong>JavaScript Controller</strong> contains a bunch of JS-Code to interact between the HTML-View and the REST-Resources.</p></li>
                                <li><p><strong>HTML View</strong> is our template that provides basic HTML components for the JavaScript Controller to hook into.</p></li>
                            </ul>
                        </li>
                        <li><p><strong>UserRestResource</strong> provides REST Resources for searching JIRA usernames via <a href="https://de.wikipedia.org/wiki/Java_API_for_XML_Web_Services" target="_blank">JAX-WS</a>.</p></li>
                        <li><p><strong>KitchenDutyPlanningRestResource</strong> provides REST Resources for CRUD operations on the KitchenDutyPlanningModel via <a href="https://de.wikipedia.org/wiki/Java_API_for_XML_Web_Services" target="_blank">JAX-WS</a>.</p></li>
                        <li><p><strong>KitchenDutyPlanningModel</strong> is our simple Pojo Model which we use to persist Data and also use as JSON representation in the JavaScript controller.</p></li>
                    </ul>

                    <div class="cs-v-spacer cs-v-spacer--big"></div>






                    
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="webwork-action-and-html-view"
        data-scroll-to-headline-previous="story-workshop-for-planning-page">
        
        Webwork Action and HTML View
    </h2>


                    <p>You might say <em>&ldquo;WebworkAction? That came out of nowhere!&rdquo;</em> and you are right. I will introduce you to it, since this is one way to provide Pages inside JIRA in a nice way.</p>

                    <p>You can read about <a href="https://developer.atlassian.com/jiradev/jira-platform/jira-architecture/jira-technical-overview/jira-webwork-actions">JIRA Webwork Action</a> or <a href="https://developer.atlassian.com/jiradev/jira-platform/building-jira-add-ons/jira-plugins2-overview/jira-plugin-module-types/webwork-plugin-module">Webwork plugin module</a>
                    but you will also understand what is going on after my short introduction.</p>

                    <p><strong>Introduction</strong></p>

                    <ul>
                        <li>
                            <p>
                                Basically <strong>Webwork Actions are Controllers</strong> (<a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC paradigm</a>) that react to certain URLs in JIRA.
                            </p>
                        </li>
                        <li>
                            <p>
                                They <strong>handle Authentication</strong> (is user logged in?) <strong>and Authorisation</strong> (has user rights to view page?) easily.
                            </p>
                        </li>
                        <li>
                            <p>
                                They let us <strong>define multiple Views</strong> (<a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC paradigm</a>) for example an Error-View and a Success-View.
                            </p>
                        </li>
                        <li>
                            <p>
                                They <strong>provide Template Renderer</strong> like Velocity which helps us to inject some variables into the View.
                            </p>
                        </li>
                        <li>
                            They are easily <strong>defined with some XML code</strong> in the <code>atlassian-plugin.xml</code> file <em>(we will learn later more about that)</em>.
                        </li>
                    </ul>

                    <div class="cs-v-spacer cs-v-spacer--small"></div>


                    <p>Ok now you know enough to get started. Open a terminal and change inside the directory of the plugin.</p>

                    <p>We will again use the Atlassian SDK to generate the basic files for us. Type the command and choose <strong>31. Webwork Plugin</strong></p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        atlas-create-jira-plugin-module<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">Choose Plugin Module:
<span class="hljs-number">1</span>:  Component Import
<span class="hljs-number">2</span>:  Component
<span class="hljs-number">3</span>:  Component Tab Panel
...
<span class="hljs-number">31</span>: Webwork Plugin
...
<span class="hljs-number">34</span>: Workflow Validator
Choose a number (<span class="hljs-number">1</span>/<span class="hljs-number">2</span>/<span class="hljs-number">3</span>.../<span class="hljs-number">33</span>/<span class="hljs-number">34</span>): <span class="hljs-number">31</span>
Enter Plugin Module Name My Webwork Module: : Kitchen Duty Planning Webwork Module
Show Advanced Setup? (Y/y/N/n) N: : Y
Module Key kitchen-duty-planning-webwork-module: :
Module Description The Kitchen Duty Planning Webwork Module Plugin: :
i18n Name Key kitchen-duty-planning-webwork-module.name: :
i18n Description Key kitchen-duty-planning-webwork-module.description: :
Enter Action Classname MyActionClass: : KitchenDutyPlanningWebworkAction
Enter Package Name com.comsysto.jira.webwork: : com.comsysto.kitchen.duty.webwork
Enter Alias KitchenDutyPlanningWebworkAction: :
Enter View Name success: : kitchen-duty-planning-success
Enter Template Path /templates/.../kitchen-duty-planning-success.vm: : /templates/kitchen-duty-planning-webwork-module/kitchen-duty-planning-success.vm
Add Another View? (Y/y/N/n) N: : N
Add Another Action? (Y/y/N/n) N: : N
[INFO] Adding the following items to the project:
[INFO]   [class: com.comsysto.kitchen.duty.webwork.KitchenDutyPlanningWebworkAction]
[INFO]   [class: ut.com.comsysto.kitchen.duty.webwork.KitchenDutyPlanningWebworkActionTest]
[INFO]   [dependency: org.apache.httpcomponents:httpclient]
[INFO]   [dependency: org.mockito:mockito-all]
[INFO]   [dependency: org.slf4j:slf4j-api]
[INFO]   [module: webwork1]
[INFO]   [resource: kitchen-duty-planning-success.vm]
[INFO]   i18n strings: <span class="hljs-number">2</span>
Add Another Plugin Module? (Y/y/N/n) N: : N
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: <span class="hljs-number">10</span>:<span class="hljs-number">53</span> min
[INFO] Finished at: <span class="hljs-number">2015</span>-<span class="hljs-number">12</span>-<span class="hljs-number">16</span>T14:<span class="hljs-number">12</span>:<span class="hljs-number">07</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>
[INFO] Final Memory: <span class="hljs-number">29</span>M/<span class="hljs-number">309</span>M
[INFO] ------------------------------------------------------------------------</code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="atlas-create-jira-plugin-module"><i class="fa fa-files-o"></i></a>
</div>


                    <p>After we have done that we see that a lot of code and files have been generated. You can see all changes in this <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/commit/162ed706c7f4be0356871a4a6f8bb6398b38854f">GitHub Commit 162ed706c7f4be0356871a4a6f8bb6398b38854f</a>.</p>

                    <p>What is important for us are the following changes:</p>

                    <ul>
                        <li>
                            <p><code>atlassian-plugin.xml</code> contains now the webwork definiton of our Action and View.</p>

                            
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">webwork1</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-planning-webwork-module"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"Kitchen Duty Planning Webwork Module"</span> <span class="hljs-attribute">i18n-name-key</span>=<span class="hljs-value">"kitchen-duty-planning-webwork-module.name"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">description</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-planning-webwork-module.description"</span>&gt;</span>The Kitchen Duty Planning Webwork Module Plugin<span class="hljs-tag">&lt;/<span class="hljs-title">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">actions</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"com.comsysto.kitchen.duty.webwork.KitchenDutyPlanningWebworkAction"</span> <span class="hljs-attribute">alias</span>=<span class="hljs-value">"KitchenDutyPlanningWebworkAction"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">view</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"kitchen-duty-planning-success"</span>&gt;</span>/templates/kitchen-duty-planning-webwork-module/kitchen-duty-planning-success.vm<span class="hljs-tag">&lt;/<span class="hljs-title">view</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">action</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">actions</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">webwork1</span>&gt;</span></code></pre>

                        </li>
                        <li>
                            <p><code>pom.xml</code> contains now needed dependencies.</p>

                            
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.apache.httpcomponents<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>httpclient<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>4.1.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.6.6<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.mockito<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>mockito-all<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.8.5<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span></code></pre>



                        </li>
                    </ul>


                    <p>You should be able to open the <code>KitchenDutyPlanningWebworkAction</code> in IntelliJ now.</p>


                    <p>
                        <a href="./images/doc/step-01-intellij-after-webwork-module-create.png" data-lightbox="01-step-server-side" data-title="Step 1 - IntelliJ after Webwork Module creation">
                            <img src="./images/doc/step-01-intellij-after-webwork-module-create.png" class="img-thumbnail img-responsive" alt="Step 1 - IntelliJ after Webwork Module creation">
                        </a>
                    </p>

                    <p>Now we change the <code>execute</code> Method to work with our view:</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-annotation">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
   <span class="hljs-keyword">return</span> <span class="hljs-string">"kitchen-duty-planning-success"</span>;
}</code></pre>


                    <p>Now our view will be called when we browse to the Webactions URL which is simply <code>http://server/jira/secure/[WebWorkAlias].jspa</code> in our case <code>http://server/jira/secure/KitchenDutyPlanningWebworkAction.jspa</code>.</p>

                    <p>We will now start JIRA wich will have our Plugin installed with the following command. (Go get another coffee, this will take some time to download dependencies)</p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        atlas-run<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">...
[INFO] [talledLocalContainer] INFORMATION: Server startup <span class="hljs-keyword">in</span> <span class="hljs-number">37754</span> ms
[INFO] [talledLocalContainer] Tomcat <span class="hljs-number">8</span>.x started on port [<span class="hljs-number">2990</span>]
[INFO] jira started successfully <span class="hljs-keyword">in</span> <span class="hljs-number">59</span>s at http://localhost:<span class="hljs-number">2990</span>/jira
[INFO] Type Ctrl-D to shutdown gracefully
[INFO] Type Ctrl-C to <span class="hljs-built_in">exit</span></code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="atlas-run"><i class="fa fa-files-o"></i></a>
</div>


                    <p>Now browse to <a href="http://localhost:2990/jira/secure/KitchenDutyPlanningWebworkAction.jspa">http://localhost:2990/jira/secure/KitchenDutyPlanningWebworkAction.jspa</a> and you should see:</p>

                    <div class="row">
                        <div class="col-md-offset-2 col-md-8">
                            <a href="./images/doc/step-01-atlas-run-jira-with-kitchen-duty-planning-webwork-action.png" data-lightbox="01-step-server-side" data-title="Step 1 - Success View of Kitchen Duty Planning Webwork Action">
                                <img src="./images/doc/step-01-atlas-run-jira-with-kitchen-duty-planning-webwork-action.png" class="img-thumbnail img-responsive" alt="Step 1 - Success View of Kitchen Duty Planning Webwork Action">
                            </a>
                        </div>
                    </div>


                    <div class="cs-v-spacer cs-v-spacer--small"></div>

                    <p>
                        Alright. That is working but it does not look very nice. We will improve the look and functionality step by step.
                    </p>
                    <p>
                        <strong>What do we need to improve the UX?</strong>
                    </p>
                    <ol>
                        <li>We want to have the usual JIRA administrator page layout</li>
                        <li>We need a sidebar navigation for links to our pages</li>
                        <li>Of course we need a content section</li>
                        <li>i18n would be nice so that we can later easily make our plugin multi-language</li>
                        <li>The planning page should only be accessible for administrators</li>
                    </ol>



                    <h3 class="cs-headline cs-headline--s">1. JIRA administrator page layout <em>(Page Decorator)</em></h3>

                    <p>We know what we need and I will introduce you to the Atlassian Components which will do the job.</p>

                    <p>Edit the <strong><code>kitchen-duty-planning-success.vm</code></strong> which resides in <code>src/main/resources/templates/kitchen-duty-planning-webwork-module/</code> like this.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Planning Page - Kitchen Duty Plugin<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"decorator"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"atl.admin"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Kitchen Duty Plugin - Planning Page<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Now it looks nice :)<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre>


                    <p>
                        The important thing is the
                        <a target="_blank" href="https://developer.atlassian.com/docs/common-coding-tasks/using-standard-page-decorators"><strong>Page Decorator</strong></a>
                        part which says <code>&lt;meta name="decorator" content="atl.admin"&gt;</code>.
                        So what is that about? This statement tells the Page Decorator to render the layout for <code>atl.admin</code>
                        which is basically the administrator layout.
                    </p>

                    <p>After you have saved the changes run <code>atlas-run</code> again your shell to start JIRA and <a href="http://localhost:2990/jira/secure/KitchenDutyPlanningWebworkAction.jspa">browse to the Planning Page</a>. It should look like this now.</p>

                    <div class="row">
                        <div class="col-md-offset-2 col-md-8">
                            <p>
                                <a href="./images/doc/step-01-planning-page-decorator-atl-admin.png" data-lightbox="01-step-server-side" data-title="Step 1 - Page Decorator atl.admin">
                                    <img src="./images/doc/step-01-planning-page-decorator-atl-admin.png" class="img-thumbnail img-responsive" alt="Step 1 - Page Decorator atl.admin">
                                </a>
                            </p>
                        </div>
                    </div>

                    <p>If you had <code>atlas-run</code> still running and do not see your changes, try opening a second shell and type <code>atlas-cli</code> wait for the prompt, type <code>pi</code> and press enter. Now your plugin is force-rebuild. You can read more about that later on in the section about faster development.</p>

                    <p></p>


                    <h3 class="cs-headline cs-headline--s">2. Sidebar Navigation <em>(Web Section / Item)</em></h3>

                    <p>We could just simply fiddle our own sidebar together but that is not the professional way.
                        Do do it the professional way we will use the
                        <a href="https://developer.atlassian.com/jiradev/jira-platform/building-jira-add-ons/jira-plugins2-overview/jira-plugin-module-types/web-section-plugin-module" target="_blank">
                            Web Section Plugin Module
                        </a>
                        and the
                        <a href="https://developer.atlassian.com/docs/getting-started/plugin-modules/web-item-plugin-module" target="_blank">
                            Web Item Plugin Module
                        </a>
                        to hook into the JIRA Sidebar which renders for every administrator tab section, so that it will look like this.
                    </p>

                    <div class="row">
                        <div class="col-md-offset-2 col-md-8">
                            <p>
                                <a href="./images/doc/step-01-planning-page-web-section-and-item.png" data-lightbox="01-step-server-side" data-title="Step 1 - Web Section and Web Item">
                                    <img src="./images/doc/step-01-planning-page-web-section-and-item.png" class="img-thumbnail img-responsive" alt="Step 1 - Web Section and Web Item">
                                </a>
                            </p>
                        </div>
                    </div>

                    <p>You might need another coffee because here comes the code for the <code>atlassian-plugin.xml</code> which resides in <code>src/main/resources/</code></p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">atlassian-plugin</span>&gt;</span>
...
  <span class="hljs-tag">&lt;<span class="hljs-title">web-section</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"admin_kitchen_duty_planning_section"</span>
               <span class="hljs-attribute">name</span>=<span class="hljs-value">"admin_kitchen_duty_planning_section"</span>
               <span class="hljs-attribute">location</span>=<span class="hljs-value">"admin_plugins_menu"</span>
               <span class="hljs-attribute">weight</span>=<span class="hljs-value">"20"</span>
               <span class="hljs-attribute">i18n-name-key</span>=<span class="hljs-value">"kitchen-duty-plugin.admin.planning.page.web.section.name"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-plugin.admin.planning.page.web.section.name"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">web-section</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">web-item</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"admin_kitchen_duty_planning_webitem"</span>
            <span class="hljs-attribute">name</span>=<span class="hljs-value">"admin_kitchen_duty_planning_webitem"</span>
            <span class="hljs-attribute">section</span>=<span class="hljs-value">"admin_plugins_menu/admin_kitchen_duty_planning_section"</span>
            <span class="hljs-attribute">weight</span>=<span class="hljs-value">"15"</span>
            <span class="hljs-attribute">i18n-name-key</span>=<span class="hljs-value">"kitchen-duty-plugin.admin.planning.page.web.item.name"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-plugin.admin.planning.page.web.item.name"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">linkId</span>=<span class="hljs-value">"admin_kitchen_duty_planning_webitem_link"</span>&gt;</span>/secure/KitchenDutyPlanningWebworkAction.jspa<span class="hljs-tag">&lt;/<span class="hljs-title">link</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">web-item</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">atlassian-plugin</span>&gt;</span></code></pre>


                    <p>
                        The <strong>web-section</strong> is the "container" which hold <em>web-items</em> and has a headline.
                        <strong>Web-items</strong> are basically the navigation links and have a name and URL.
                    </p>

                    <div class="cs-v-spacer cs-v-spacer--small"></div>

                    <p><em>So what is happening here?</em></p>

                    <ul>
                        <li>
                            <p>
                            The <strong><code>web-section</code></strong> does need a <strong>unique key and name</strong>. The <strong>weight</strong> defines the order of the section relative to sections of other addons.
                            The <strong>location</strong> defines the page or tab under which the web-section should be injected; we use the Addons Tab.
                            The <code>&lt;label key</code> is some OSGi stuff I think, just name the key as the i18n-name-key.
                            Lastly the <code>i18n-name-key</code> is the identifier to the <code>kitchen-duty-plugin.properties</code> language file which contains the actual translations.
                            </p>
                        </li>
                        <li><p>
                            The <strong><code>web-item</code></strong> has the same attributes as the web-section. But you need to specify a <code>section</code> which points to our web-section name.
                            The <code>&lt;link</code> object contains the actual URL to our page.
                            </p>
                        </li>
                    </ul>


                    <div class="cs-v-spacer cs-v-spacer--small"></div>

                    <p>Since we heard about <strong>i18n</strong> now we need to define our values in the language file <code>kitchen-duty-plugin.properties</code>.</p>

                    
<pre class="cs-code"><code class="hljs"># websection/webitems
kitchen-duty-plugin.admin.planning.page.web.section.name = Kitchen Duty Plugin
kitchen-duty-plugin.admin.planning.page.web.item.name = Planning Page</code></pre>


                    <p>Alright this was a little complicated but now we have a nice sidbar navigation link.</p>


                    <h3 class="cs-headline cs-headline--s">3. Content Section <em>(AUI Layout)</em></h3>

                    <p>Ok this is a no-brainer since you already saw the content section. But to be consistent here is the screenshot ;)</p>

                    <div class="row">
                        <div class="col-md-offset-2 col-md-8">
                            <p>
                                <a href="./images/doc/step-01-planning-page-content.png" data-lightbox="01-step-server-side" data-title="Step 1 - Content Section">
                                    <img src="./images/doc/step-01-planning-page-content.png" class="img-thumbnail img-responsive" alt="Step 1 - Content Section">
                                </a>
                            </p>
                        </div>
                    </div>

                    <p>
                        If you want to be the a-student you can read about <a target="_blank" href="https://docs.atlassian.com/aui/latest/docs/layout.html">AUI Layout</a>
                        and play around a little. We will use that later to further style our pages.
                    </p>

                    <h3 class="cs-headline cs-headline--s">4. Internationalization <em>(i18n / Velocity)</em></h3>

                    <p>You already saw some i18n for web-section/item names. Now we want to i18n-ize our html template.</p>

                    <p>
                        You might have seen the file-ending <code>.vm</code> already. That means the
                        <strong><code>kitchen-duty-planning-success.vm</code></strong> is an <a target="_blank" href="http://velocity.apache.org/">Apache Velocity template</a>.
                        Some might wonder now <em>"Didn't the ancient greek use velocity?! Is it really still around?"</em>. Yes it is and I think it does a great job.
                    </p>

                    <p>So let's get to action, we will change our html code using <code>i18n.getText("i18n.key")</code> which is a velocity helper to render the i18n value for a given key.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>$i18n.getText("kitchen-duty-plugin.admin.planning.page.title")<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"decorator"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"atl.admin"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>$i18n.getText("kitchen-duty-plugin.admin.planning.page.headline")<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Now it looks nice :)<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre>


                    <p>Now we need to add the translations to the <code>kitchen-duty-plugin.properties</code> file and we are done internationalising our page.</p>

                    
<pre class="cs-code"><code class="hljs"># kitchen-duty-planning-success.vm
kitchen-duty-plugin.admin.planning.page.headline = Kitchen Duty Plugin - Planning Page
kitchen-duty-plugin.admin.planning.page.title = Planning Page - Kitchen Duty Plugin</code></pre>




                    <h3 class="cs-headline cs-headline--s">5. Admin only Authorization <em>(Webwork Action)</em></h3>

                    <p>We are using a <strong>Webwork Action</strong> for our planning page and we can simply set <code>roles-required="admin"</code> in the
                        <code>atlassian-plugin.xml</code> to enforce administrator only authorization.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">webwork1</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-planning-webwork-module"</span>
          <span class="hljs-attribute">...</span>
          <span class="hljs-attribute">roles-required</span>=<span class="hljs-value">"admin"</span>&gt;</span></code></pre>


                    <p>If you log out of JIRA now and browse again to the planning page you will see the administrator login form. When logging in as <code>admin</code> (password <code>admin</code>) you should be redirected to the planning page.</p>

                    <div class="row">
                        <div class="col-md-offset-2 col-md-8">
                            <p>
                                <a href="./images/doc/step-01-done.png" data-lightbox="01-step-server-side" data-title="Step 1 - Done">
                                    <img src="./images/doc/step-01-done.png" class="img-thumbnail img-responsive" alt="Step 1 - Done">
                                </a>
                            </p>
                        </div>
                    </div>

                    <div class="cs-v-spacer"></div>

                    <div class="cs-tutorial-step-review">
                        <div class="cs-tutorial-step-review__headline">
                            <strong>You have completed Step 1.</strong> Good Job! You can check out this steps solution on GitHub
                        </div>
                        <div class="cs-tutorial-step-review__link">
                            <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-01-kitchen-duty-plugin">
                                https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-01-kitchen-duty-plugin
                            </a>
                        </div>
                    </div>

                    <div class="cs-v-spacer cs-v-spacer"></div>

                    <p>The grafic shows <strong>which components we implemented in this section</strong>.</p>

                    <div class="row">
                        <div class="col-md-offset-3 col-md-6">
                            <p>
                                <a href="./images/drawings/01-components-done-webwork-action-and-html-view.jpg" data-lightbox="01-step-server-side" data-title="Step 1 - Components implemented after completion of Step 1">
                                    <img src="./images/drawings/01-components-done-webwork-action-and-html-view.jpg" class="img-thumbnail img-responsive" alt="Step 1 - Components implemented after completion of Step 1">
                                </a>
                            </p>
                        </div>
                    </div>

                    <div class="cs-v-spacer cs-v-spacer--big"></div>





                    
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="user-rest-resource-and-js-controller"
        data-scroll-to-headline-previous="webwork-action-and-html-view">
        
        User REST Resource and JS Controller
    </h2>



                    <p>We will now create the <strong>User Search REST Resource</strong> so that our <strong>JS-Controller can search for usernames</strong>.</p>

                    <p>What is a REST Resource? It is simply just a basic Controller (MVC) that reacts to certain HTTP Requests with a specific response.</p>

                    <p>
                        Atlassian uses <a target="_blank" href="https://en.wikipedia.org/wiki/Java_API_for_XML_Web_Services">JAX-WS</a> and <a target="_blank" href="https://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding">JAXB</a> for it's built in REST Resources.
                        The actual implementation is hidden from us, and we don't really care about it since we just need to know that somewhere inside JIRA
                        are OSGi bundles which provide the JAX-WS and JAXB implementation.</p>

                    <p>Ok, enough of OSGi and theoretical jibber jabber! Let's create our REST Resource with an Atlassian SDK command, like we did create the Webwork Action before.</p>

                    <p>Execute the command and choose <a href="https://developer.atlassian.com/docs/atlassian-platform-common-components/rest-api-development/rest-plugin-module" target="_blank"><strong>14: REST Plugin Module</strong></a> and fill out the prompts as stated below.</p>

                    
<div class="cs-shell">
    <div class="cs-shell__inner">
        atlas-create-jira-plugin-module<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">Executing: /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>/bin/mvn com.atlassian.maven.plugins:maven-jira-plugin:<span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>:create-plugin-module -gs /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>/conf/settings.xml
Java HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM warning: ignoring option MaxPermSize=<span class="hljs-number">256</span>M; support was removed <span class="hljs-keyword">in</span> <span class="hljs-number">8.0</span>
[INFO] Scanning <span class="hljs-keyword">for</span> projects...
[INFO]
[INFO] Using the builder org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder with a thread count of <span class="hljs-number">1</span>
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building kitchen-duty-plugin <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-jira-plugin:<span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>:create-plugin-module (default-cli) @ kitchen-duty-plugin ---
Choose Plugin Module:
<span class="hljs-number">1</span>:  Component Import
...
<span class="hljs-number">14</span>: REST Plugin Module
<span class="hljs-number">15</span>: RPC Endpoint Plugin
...
Choose a number (...): <span class="hljs-number">14</span>

Enter New Classname MyRestResource: : UserSearchResource
Enter Package Name com.comsysto.rest: : com.comsysto.kitchen.duty.rest
Enter REST Path /usersearchresource: : /kitchenduty
Enter Version <span class="hljs-number">1.0</span>: : <span class="hljs-number">1.0</span>

Show Advanced Setup? (Y/y/N/n) N: : y

Module Name User Search Resource: : Kitchen Duty Resources
Module Key user-search-resource: : kitchen-duty-resources
Module Description The User Search Resource Plugin: : All Kitchen Duty REST Resources
i18n Name Key user-search-resource.name: : kitchen-duty-plugin.rest.resources.name
i18n Description Key user-search-resource.description: : kitchen-duty-plugin.rest.resources.description
Add Package To Scan? (Y/y/N/n) N: : y
Enter Package: com.comsysto.kitchen.duty.rest
...

Add Package To Scan? (Y/y/N/n) N: : n

Add Dispatcher? (Y/y/N/n) N: : n

[INFO] Adding the following items to the project:
[INFO]   [class: com.comsysto.kitchen.duty.rest.UserSearchResourceModel]
[INFO]   [class: com.comsysto.kitchen.duty.rest.UserSearchResource]
[INFO]   [class: it.com.comsysto.kitchen.duty.rest.UserSearchResourceFuncTest]
[INFO]   [class: ut.com.comsysto.kitchen.duty.rest.UserSearchResourceTest]
[INFO]   [dependency: com.atlassian.plugins.rest:atlassian-rest-common]
[INFO]   [dependency: com.atlassian.sal:sal-api]
[INFO]   [dependency: javax.servlet:servlet-api]
[INFO]   [dependency: javax.ws.rs:jsr311-api]
[INFO]   [dependency: javax.xml.bind:jaxb-api]
[INFO]   [dependency: org.apache.wink:wink-client]
[INFO]   [dependency: org.mockito:mockito-all]
[INFO]   [module: rest]
[INFO]   i18n strings: <span class="hljs-number">2</span>

Add Another Plugin Module? (Y/y/N/n) N: : n

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: <span class="hljs-number">01</span>:<span class="hljs-number">52</span> min
[INFO] Finished at: <span class="hljs-number">2016</span>-<span class="hljs-number">01</span>-<span class="hljs-number">16</span>T20:<span class="hljs-number">07</span>:<span class="hljs-number">35</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>
[INFO] Final Memory: <span class="hljs-number">24</span>M/<span class="hljs-number">328</span>M
[INFO] ------------------------------------------------------------------------</code></pre>

    </div>
    <a class="cs-shell__copy-clipboard" data-clipboard-text="atlas-create-jira-plugin-module"><i class="fa fa-files-o"></i></a>
</div>



                    <p>The SDK created and updated many files now and before we get into all the details let's fire up <code>atlas-run</code> again
                    and see what has been created for us.</p>

                    <p>Once JIRA is started <strong>browse to <a href="http://server/jira/rest/kitchenduty/1.0/message" target="_blank">http://server/jira/rest/kitchenduty/1.0/message</a></strong> and you should see the following.</p>

                    <div class="row">
                        <div class="col-md-offset-2 col-md-8">
                            <p>
                                <a href="./images/doc/step-02-rest-user-search-response-xml.png" data-lightbox="02-step" data-title="Step 2 - XML Response of User Search REST Resource">
                                    <img src="./images/doc/step-02-rest-user-search-response-xml.png" class="img-thumbnail img-responsive" alt="Step 2 - XML Response of User Search REST Resource">
                                </a>
                            </p>
                        </div>
                    </div>

                    <p>That's nice. But now we need to understand what is going on. So here is a <strong>short recap of what has been created</strong>.</p>

                    <ol>
                        <li><p>The <code>pom.xml</code> has been altered to provide necessary dependencies for JAX-WS API, Servlet API and some testing Dependencies.</p></li>
                        <li><p>The <code>atlassian-plugin.xml</code> has been altered to register the REST Resource to listen to the baseUrl <code>http://server/jira/rest/kitchenduty/1.0/*</code></p></li>
                        <li><p>There now is a <code>UserSearchResource.java</code> which is the actual REST Controller which delivers the response.</p></li>
                        <li><p>In addition to the REST Controller there is <code>UserSearchResourceModel.java</code> which is the Model which is delivered as XML in the REST Controllers response.</p></li>
                    </ol>

                    <p>We will now get into all the details and implement the needed features for the user search on the fly.</p>

                    <h3 class="cs-headline cs-headline--s">1. Dependencies <em>(pom.xml)</em></h3>

                    <p>The <code>pom.xml</code> has these new lines which are quite self explanatory. If you want to read everything in detail read the <a href="https://developer.atlassian.com/docs/atlassian-platform-common-components/rest-api-development/rest-plugin-module" target="_blank">REST Plugin Module documentation</a>.</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>javax.servlet<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>servlet-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.4<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>javax.xml.bind<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>jaxb-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.atlassian.plugins.rest<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>atlassian-rest-common<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.0.2<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.apache.wink<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>wink-client<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.1.3-incubating<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span></code></pre>


                    




                    <h3 class="cs-headline cs-headline--s">2. REST Resources Handler <em>(atlassian-plugin.xml)</em></h3>

                    <p>As already mentioned the <code>atlassian-plugin.xml</code> has been altered to register the REST Resource to listen to the baseUrl <code>http://server/jira/rest/kitchenduty/1.0/*</code>.</p>

                    <p>The <code>path</code> and <code>version</code> build the baseurl relative to <code>http://server/jira/rest/*</code>.</p>

                    <p><code>package</code> will enable Component Scan (which I think is redundant, but doesn't hurt).</p>

                    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">rest</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"Kitchen Duty Resources"</span>
      <span class="hljs-attribute">i18n-name-key</span>=<span class="hljs-value">"kitchen-duty-plugin.rest.resources.name"</span>
      <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-resources"</span>
      <span class="hljs-attribute">path</span>=<span class="hljs-value">"/kitchenduty"</span>
      <span class="hljs-attribute">version</span>=<span class="hljs-value">"1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">description</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-plugin.rest.resources.description"</span>&gt;</span>All Kitchen Duty REST Resources<span class="hljs-tag">&lt;/<span class="hljs-title">description</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">package</span>&gt;</span>com.comsysto.kitchen.duty.rest<span class="hljs-tag">&lt;/<span class="hljs-title">package</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">rest</span>&gt;</span></code></pre>


                    <p>You already know <code>i18n-name-key</code> and the other attributes from the Webwork Action and therefore are not wondering that there are some new i18n key/value pairs inside <code>kitchen-duty-plugin.properties</code>.</p>

                    
<pre class="cs-code"><code class="hljs">kitchen-duty-plugin.rest.resources.name=Kitchen Duty Resources
kitchen-duty-plugin.rest.resources.description=All Kitchen Duty REST Resources</code></pre>



                    <h3 class="cs-headline cs-headline--s">3. REST Controller and Model</h3>

                    <p>
                        In the directory <code>src/main/java/</code> in the package <code>com.comsysto.kitchen.duty.rest</code> there is now the
                        <code>UserSearchResource.java</code> and the <code>UserSearchResourceModel.java</code>.
                    </p>

                    <p>
                        Change the code of the <strong><code>UserSearchResource.java</code></strong> to the following to <strong>provide GET Endpoint to search usernames</strong>.
                    </p>


                    <p></p>
                    


                    

                    

                    

                    <div class="cs-v-spacer cs-v-spacer--big"></div>
                    <div class="cs-v-spacer cs-v-spacer--big"></div>



                    <div class="alert alert-info cs-summary">
                        <p><strong>TO BE CONTINUED</strong> - We will continue this tutorial soon.</p>
                        <hr class="cs-summary__spacer">
                        <p>We will then tend to</p>
                        <ul>
                            <li><p>Creating REST Resources for UserSearch and KitchenDutyPlanningModel operations.</p></li>
                            <li><p>Creating JavaScript Controller and HTML view with Atlassian AUI and interact with REST Resources.</p></li>
                        </ul>
                        <hr class="cs-summary__spacer">
                        <p>Of course there will be more steps following after that. </p>
                    </div>










                    <div class="cs-v-spacer cs-v-spacer--big"></div>

                    <div class="cs-v-spacer cs-v-spacer--big"></div>

                    <div class="cs-v-spacer cs-v-spacer--big"></div>





                </div>
            </div>

            <div class="row">
                <div class="col-md-12 cs-license-container">

                    <hr class="cs-divider">

                    <strong>License and Author</strong>
                    <p>
                      The project sources are free for personal and commercial use under the terms of the <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported (CC BY 3.0) License</a>.
                      The author is <a href="http://comsysto.com/">comSysto GmbH</a>. The <a href="https://thenounproject.com/term/dishwasher/29752/">dishes icon</a> in the logo is licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 (CC BY 3.0 US) License</a></p>

                    <hr class="cs-divider">
                    <strong><a href="http://comsysto.com/imprint.html">Impressum</a></strong> ~ <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira">View project on GitHub</a>

                    <div class="cs-v-spacer"></div>

                </div>
            </div>
        </div>
    </div>
</div>










<script src="./generated/bundle.js" async></script>



</body>
</html>
