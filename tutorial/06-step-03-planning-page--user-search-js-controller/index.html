<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    
    <title>User Search JS Controller ~ Planning Page | Kitchen Duty Plugin for Atlassian JIRA® by comSysto</title>
    <meta description="An interactive step-by-step tutorial on how to write Plugins for Atlassian JIRA® by comSysto">
    <meta name="robots" content="noindex, nofollow">


    
    <meta property="og:title" content="Kitchen Duty Plugin for Atlassian JIRA® by comSysto" />
    <meta property="og:image" content="https://comsysto.github.io/kitchen-duty-plugin-for-atlassian-jira/images/kitchen-duty-plugin--social.jpg" />
    <meta property="og:description" content="An interactive tutorial on how to write Plugins for Atlassian JIRA® by comSysto" />

    
    <link rel="canonical" href="https://comsysto.github.io/kitchen-duty-plugin-for-atlassian-jira/tutorial/06-step-03-planning-page--user-search-js-controller/" />



    <link href="/kitchen-duty-plugin-for-atlassian-jira/generated/bundle.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Menlo|Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Patrick+Hand' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,900,700|Source+Sans+Pro:400,300,600' rel='stylesheet' type='text/css'>

    <link rel="icon" href="/kitchen-duty-plugin-for-atlassian-jira/images/favicon-32.png" type="image/png" sizes="32x32">
    <link rel="icon" href="/kitchen-duty-plugin-for-atlassian-jira/images/favicon-256.png" type="image/png" sizes="256x256">
    <link rel="icon" href="/kitchen-duty-plugin-for-atlassian-jira/images/favicon.svg" type="image/svg+xml">

    <script>var postLoadMethods = [];</script>
</head>
<body class="cs-tutorial-body">




















    
        
        
        
        
            
        
        
        

        <div class="cs-toc-infographic-wrapper">
            
    <svg class="cs-interactive-graphic"
         id="navSvg11"
         data-json-settings="{
                    &quot;markedAsDone&quot;: [ &quot;webwork-action&quot;, &quot;html-view&quot;, &quot;user-resource&quot;, &quot;user-search-resource-model&quot; ],
                    &quot;markedAsTodo&quot;: [ &quot;user-js-controller&quot; ],
                    &quot;markedAsGrayedOut&quot;: [ ],
                    &quot;onClick&quot;: [ ]
                }"
         data-svg-to-load="kitchen-duty-planning-page--component-overview"
         width="100%"
         viewBox="0 0 1043 654"
         preserveAspectRatio="xMaxYMax">
    </svg>

        </div>
    


    <div class="container-fluid cs-page-header">
        <div class="row">
            <div class="col-md-6 cs-page-header--left-fix">
                <a href="/kitchen-duty-plugin-for-atlassian-jira/"><span class="cs-page-logo">
                <h1>Kitchen Duty Plugin</h1>
                <h2>for Atlassian JIRA® by comSysto</h2>
            </span></a>

            </div>
            <div class="col-md-6  cs-page-header-cs-logo text-xs-right hidden-xs hidden-sm  cs-page-header--right-fix">
                <a href="https://comsysto.com/leistungen/atlassian-experts-services" target="_blank"><img src="/kitchen-duty-plugin-for-atlassian-jira/images/comsysto-logo.png" alt="comSysto"/></a>
            </div>
        </div>

    </div>

<!-- CONTENT -->



<div class="cs-sidebar-wrapper">
            
    <div id="toc">
        <ul>

            

            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/01-introduction/">
                    Introduction
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/02-step-00-getting-started/">
                    <span class="cs-step-badge pull-right">0</span>
                    Getting Started
                </a>
            </li>

            

            <li class="toc-h2-divider">Kitchen Duty Planning Page</li>

            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/03-story-workshop-for-planning-page/">
                    Story Workshop for Planning Page
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/04-step-01-planning-page--webwork-action-and-html-view/">
                    <span class="cs-step-badge pull-right">1</span>
                    Webwork Action and HTML View
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/05-step-02-planning-page--user-search-rest-resource/">
                    <span class="cs-step-badge pull-right">2</span>
                    User Search REST Resource
                </a>
            </li>
            <li class="toc-h2 toc-active"><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/06-step-03-planning-page--user-search-js-controller/">
                    <span class="cs-step-badge pull-right">3</span>
                    User Search JS Controller
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/07-step-04-planning-page--kitchen-duty-planning-rest-resource/">
                    <span class="cs-step-badge pull-right">4</span>
                    Kitchen Duty Planning REST Resource
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/08-step-05-planning-page--kitchen-duty-planning-js-controller/">
                    <span class="cs-step-badge pull-right">5</span>
                    Kitchen Duty Planning JS Controller
                </a>
            </li>

            

            <li class="toc-h2-divider">Kitchen Duty Overview Page</li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/09-story-workshop-for-overview-page/">
                    Story Workshop for Overview Page
                </a>
            </li>
        </ul>


    </div>


</div>

<div class="cs-content-wrapper">
    



<div class="row">
    <div class="col-md-12">
        
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="user-search-js-controller"
        data-scroll-to-headline-previous="">
        
        User Search JS Controller
    </h2>


        


        
        
        


        <p>In the previous section we implemented the User Search REST Endpoint which we will now use
        from our JS Controller. You might want to check the <a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/03-story-workshop-for-planning-page/">Story Workshop</a> again to see what we
        want to build here.</p>


        <h3 class="cs-headline cs-headline--s">AUI and JIRA Version?</h3>


        <div class="row">
            <div class="col-md-6">
                <p>Ok so we want to use the <strong><a href="https://docs.atlassian.com/aui/latest/docs/auiselect2.html">Select2 Widget from the AUI Framework</a></strong>.
                    First you have to know that each version of JIRA has AUI prepackaged in a certain version.
                    Therefore we will use that and not pull in a second version of that (really, don't do that).</p>

                <p>So we do a <code>atlas-run</code> and wait for JIRA to startup. Now open the Browser Console
                    and type:</p>


                
<div class="cs-shell">
    <div class="cs-shell__inner">
        <a class="cs-shell__copy-clipboard cs--trigger-copy-clipboard" data-clipboard-text="AJS.version"
           data-toggle="tooltip" data-placement="left"
           data-title-orig="Copy file content to clipboard"
           title="Copy file content to clipboard"><i class="fa fa-files-o"></i></a>

        AJS.version<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs"><span class="hljs-number">5.7</span>.<span class="hljs-number">31</span></code></pre>

    </div>
</div>



                <p>It will print the exact version used in the JIRA target version we code our plugin for.
                    At this point you really have to think about the range of versions you want to support with
                    your plugin. If you want to support older JIRA versions you need to know the lowest version of AUI
                    availabe and code with backwardscompatibility in mind. To make things simpler we assume that our
                    plugin will be compatible starting from JIRA 7.0 up to the latest JIRA version (currently 7.1.x).</p>

                <p>Alright now open the
                    <a href="https://docs.atlassian.com/aui/5.7.31/docs/applicationHeader.html" target="_blank">AUI documentation for 5.7.31</a>
                    and select AUI Select 2 documentation.
                    Ok no offense to the people writing the docs but it is a little thin and it took me some
                    time to come up with a hassle-free way to use the Select 2 the way I want it to behave.
                    You just read the doc and I will provide you some code you should like.</p>
            </div>
            <div class="col-md-offset-1 col-md-5">
                <p>
                    <a href="/kitchen-duty-plugin-for-atlassian-jira/images/doc/step-03-ajs-version.png" data-lightbox="03-step" data-title="Step 3 - Find out the AJS/AUI Version">
                        <img src="/kitchen-duty-plugin-for-atlassian-jira/images/doc/step-03-ajs-version.png" class="img-thumbnail img-fluid" alt="Step 2 - Find out the AJS/AUI Version">
                    </a>
                </p>
            </div>
        </div>


        <h3 class="cs-headline cs-headline--s">What about JS Frameworks, Template Engines and jQuery?</h3>

        <p>Alright that is it about our Widget. But how do we write our JavaScript code?
        Is there any template engine? Any watchers and/or frameworks? You have good point there.
        Let me tell you a short tale about JIRA and JavaScript...

        <p>Ok basically we already used <code>AJS.version</code> before, so you might have already wondered
        what that actually was. <strong>JIRA bundles a lightweight jQuery which is bound to <code>AJS</code></strong>
        there is no <code>$</code> or <code>jQuery</code> and even if there were you are advised to
        use <code>AJS</code> prefix. So here is a basic example:</p>


        
<div class="cs-shell">
    <div class="cs-shell__inner">
        <a class="cs-shell__copy-clipboard cs--trigger-copy-clipboard" data-clipboard-text="var theFooElement = AJS.$(&#39;#foo&#39;);"
           data-toggle="tooltip" data-placement="left"
           data-title-orig="Copy file content to clipboard"
           title="Copy file content to clipboard"><i class="fa fa-files-o"></i></a>

        var theFooElement = AJS.$(&#39;#foo&#39;);<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">undefined</code></pre>

    </div>
</div>


        <p>It will select the DOM element with id foo (when there is no such element it will return <code>undefined</code>).
            Ok just take that in for now, I know it is unfamiliar but we will get used to it.</p>

        <p>So what about template Engines? Unfortunately there seems to be nothing here. Therefore I use
        handlebars.js myself. Why that framework? Good question. Because it does not pull in or rely on jQuery
        or other thirdparty js frameworks and just registers on global that does not interfere with JIRA.</p>

        <div class="cs-blockquote">
            <p>Small is beautiful - Avoid using big JavaScript frameworks that will register globals, bring in dependencies and tend to overwrite stuff that might break JIRA functionality.</p>
        </div>


        <p>Alright let's resume what we are going to use:</p>

        <ul>
            <li>lightweight jQuery provided with <code>AJS</code> prefix</li>
            <li>AUI framework methods like <code>AJS.getI18nText</code></li>
            <li><a href="http://handlebarsjs.com/" target="_blank">handlebars.js template engine</a></li>
            <li>html page with serverside velocity (which we will not use to much)</li>
        </ul>



        <h3 class="cs-headline cs-headline--s">Basic setup of JS Dependencies and Controller</h3>


        <p>First we <strong><a href="http://handlebarsjs.com/installation.html">download the <code>handlebars.js</code></a> file</strong> and put
            it here <code>/src/main/resources/js/3rdparty/handelbars-v4.0.5.js</code>.
            (You can use bower, npm and other tools if you want to integrate that into your build. But we want to keep it simple here.)</p>

        <p>Now we <strong>create our JS-Controller</strong> file in <code>/src/main/resources/js/kitchen-duty-plugin--planning-page-controller.js</code>.
        We put some simple dummy code inside which will trigger a <a href="https://docs.atlassian.com/aui/5.7.31/docs/flag.html">message flag</a> on pageload just to see if everything is working.</p>

        
    
        <div class="cs-code-filename">src/main/resources/js/kitchen-duty-plugin--planning-page-controller.js
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-03-kitchen-duty-plugin/src/main/resources/js/kitchen-duty-plugin--planning-page-controller.js" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="AJS.toInit(function(){
   require([&#39;aui/flag&#39;], function(flag) {
       var myFlag = flag({
           type: &#39;success&#39;,
           title: &#39;Kitchen Duty Plugin&#39;,
           body: &#39;JS Controller is working&#39;
       });
   });
});"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs">AJS.toInit(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
   <span class="hljs-built_in">require</span>([<span class="hljs-string">'aui/flag'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">flag</span>) </span>{
       <span class="hljs-keyword">var</span> myFlag = flag({
           type: <span class="hljs-string">'success'</span>,
           title: <span class="hljs-string">'Kitchen Duty Plugin'</span>,
           body: <span class="hljs-string">'JS Controller is working'</span>
       });
   });
});</code></pre>


        <p>Our new JS Controller will not just work out of the box. We need to define a resource in <code>atlassian-plugin.xml</code>
            for our controller and the handlebar.js file.</p>

        
    
        <div class="cs-code-filename">src/main/resources/atlassian-plugin.xml
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-03-kitchen-duty-plugin/src/main/resources/atlassian-plugin.xml" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="&lt;web-resource key=&quot;kitchen-duty-plugin-resources--planning-page&quot; name=&quot;kitchen-duty-plugin Web Resources for Planning Page&quot;&gt;
	&lt;dependency&gt;com.atlassian.auiplugin:ajs&lt;/dependency&gt;
	&lt;resource type=&quot;download&quot; name=&quot;kitchen-duty-plugin--planning-page-controller.js&quot; location=&quot;/js/kitchen-duty-plugin--planning-page-controller.js&quot;/&gt;
	&lt;resource type=&quot;download&quot; name=&quot;handlebars.js&quot; location=&quot;/js/3rdparty/handlebars-v4.0.5.js&quot;/&gt;
	&lt;context&gt;kitchen-duty-plugin&lt;/context&gt;
&lt;/web-resource&gt;"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">web-resource</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-plugin-resources--planning-page"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"kitchen-duty-plugin Web Resources for Planning Page"</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>com.atlassian.auiplugin:ajs<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">resource</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"download"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"kitchen-duty-plugin--planning-page-controller.js"</span> <span class="hljs-attribute">location</span>=<span class="hljs-value">"/js/kitchen-duty-plugin--planning-page-controller.js"</span>/&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">resource</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"download"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"handlebars.js"</span> <span class="hljs-attribute">location</span>=<span class="hljs-value">"/js/3rdparty/handlebars-v4.0.5.js"</span>/&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">context</span>&gt;</span>kitchen-duty-plugin<span class="hljs-tag">&lt;/<span class="hljs-title">context</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">web-resource</span>&gt;</span></code></pre>


        <p>We have defined the resource now but JIRA does not know when to use (load) the resources we defined.
        <strong>We will use the PageBuilderService to tell JIRA when to load our resources</strong>. (You might want to try <code>#require</code> in your velocity templates instead, but PageBuilderService always worked best for me)</p>

        <p>We pull in some additional dependencies to be able to use PageBuilderService. Add these dependencies to your <code>pom.xml</code>.</p>


        
    
        <div class="cs-code-filename">pom.xml
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-03-kitchen-duty-plugin/pom.xml" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="&lt;dependency&gt;
	&lt;groupId&gt;com.atlassian.templaterenderer&lt;/groupId&gt;
	&lt;artifactId&gt;atlassian-template-renderer-api&lt;/artifactId&gt;
	&lt;version&gt;1.5.7&lt;/version&gt;
	&lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
	&lt;groupId&gt;com.atlassian.plugins&lt;/groupId&gt;
	&lt;artifactId&gt;atlassian-plugins-webresource&lt;/artifactId&gt;
	&lt;version&gt;3.3.3&lt;/version&gt;
	&lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.atlassian.templaterenderer<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>atlassian-template-renderer-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.5.7<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.atlassian.plugins<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>atlassian-plugins-webresource<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>3.3.3<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span></code></pre>


        <p>We already learned that we need to do a <code>@ComponentImport</code> somewhere in our application to pull dependencies from other OSGi Bundles.
        That is why we simply do that in our <code>MyPluginComponentImpl.java</code> file which we will (mis)use for that purpose from now on.</p>

        
    
        <div class="cs-code-filename">src/main/java/com/comsysto/kitchen/duty/impl/MyPluginComponentImpl.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-03-kitchen-duty-plugin/src/main/java/com/comsysto/kitchen/duty/impl/MyPluginComponentImpl.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="import com.atlassian.webresource.api.assembler.PageBuilderService;

...

@ComponentImport
private PageBuilderService pageBuilderService;"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">import</span> com.atlassian.webresource.api.assembler.PageBuilderService;

...

<span class="hljs-annotation">@ComponentImport</span>
<span class="hljs-keyword">private</span> PageBuilderService pageBuilderService;</code></pre>


        <p>Now that the PageBuilderService is usable we need to tell our Webwork Action to load our resources.</p>

        <div class="row">
            <div class="col-md-8">
                
    
        <div class="cs-code-filename">src/main/java/com/comsysto/kitchen/duty/webwork/KitchenDutyPlanningWebworkAction.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-03-kitchen-duty-plugin/src/main/java/com/comsysto/kitchen/duty/webwork/KitchenDutyPlanningWebworkAction.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="package com.comsysto.kitchen.duty.webwork;

import com.atlassian.webresource.api.assembler.PageBuilderService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import com.atlassian.jira.web.action.JiraWebActionSupport;

import javax.inject.Inject;
import javax.inject.Named;

@Named {{{point::1}}}
public class KitchenDutyPlanningWebworkAction extends JiraWebActionSupport
{
    private static final Logger log = LoggerFactory.getLogger(KitchenDutyPlanningWebworkAction.class);

    @Inject {{{point::2}}}
    private PageBuilderService pageBuilderService;

    @Override
    public String execute() throws Exception {
        pageBuilderService.assembler().resources().requireWebResource(
           &quot;com.comsysto.kitchen-duty-plugin:kitchen-duty-plugin-resources&quot; {{{point::3}}}
        ).requireWebResource(
           &quot;com.comsysto.kitchen-duty-plugin:kitchen-duty-plugin-resources--planning-page&quot;
        );

        return &quot;kitchen-duty-planning-success&quot;;
    }

    public void setPageBuilderService(PageBuilderService pageBuilderService) { {{{point::4}}}
        this.pageBuilderService = pageBuilderService;
    }
}"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">package</span> com.comsysto.kitchen.duty.webwork;

<span class="hljs-keyword">import</span> com.atlassian.webresource.api.assembler.PageBuilderService;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;
<span class="hljs-keyword">import</span> com.atlassian.jira.web.action.JiraWebActionSupport;

<span class="hljs-keyword">import</span> javax.inject.Inject;
<span class="hljs-keyword">import</span> javax.inject.Named;

<span class="hljs-annotation">@Named</span> <span class="cs-source-point" data-cs-source-point-id="h768go8gbo8gv8gbu909" data-cs-source-point-number="1"></span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KitchenDutyPlanningWebworkAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">JiraWebActionSupport</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger log = LoggerFactory.getLogger(KitchenDutyPlanningWebworkAction.class);

    <span class="hljs-annotation">@Inject</span> <span class="cs-source-point" data-cs-source-point-id="h768go8gbo8gv8gbu909" data-cs-source-point-number="2"></span>
    <span class="hljs-keyword">private</span> PageBuilderService pageBuilderService;

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        pageBuilderService.assembler().resources().requireWebResource(
           <span class="hljs-string">"com.comsysto.kitchen-duty-plugin:kitchen-duty-plugin-resources"</span> <span class="cs-source-point" data-cs-source-point-id="h768go8gbo8gv8gbu909" data-cs-source-point-number="3"></span>
        ).requireWebResource(
           <span class="hljs-string">"com.comsysto.kitchen-duty-plugin:kitchen-duty-plugin-resources--planning-page"</span>
        );

        <span class="hljs-keyword">return</span> <span class="hljs-string">"kitchen-duty-planning-success"</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPageBuilderService</span><span class="hljs-params">(PageBuilderService pageBuilderService)</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="h768go8gbo8gv8gbu909" data-cs-source-point-number="4"></span>
        <span class="hljs-keyword">this</span>.pageBuilderService = pageBuilderService;
    }
}</code></pre>

            </div>
            <div class="col-md-4">
                <div class="list-group cs-source-point-list" data-source-target="h768go8gbo8gv8gbu909">
                    <div class="list-group-item cs-source-point-list__item">
                        Define our <code>KitchenDutyPlanningWebworkAction</code> as <code>@Named</code>-component.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        Use <code>@Inject</code> to wire the <code>PageBuilderService</code>.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        We tell the PageBuilderService via <code>requireWebResource()</code>
                        to load our share resource bundle and our planning-page bundle containing the controller and handlebars.
                        The pattern for require is <code>"pluginKey:resourceKey"</code>.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        And of course a setter for the setter injection of PageBuilderService.
                    </div>
                </div>
            </div>
        </div>


        <p>After starting up JIRA via <code>atlas-run</code> (you should restart atlas-run because we added something to pom.xml) you
            <strong>should see a green success message popping up on the top right </strong> when
        surfing to planning page: <a class="cs-do-wrap" href="http://localhost:2990/jira/secure/KitchenDutyPlanningWebworkAction.jspa">http://localhost:2990/jira/secure/KitchenDutyPlanningWebworkAction.jspa</a></p>



        <div class="row">
            <div class="col-md-offset-2 col-md-8">
                <p>
                    <a href="/kitchen-duty-plugin-for-atlassian-jira/images/doc/step-03-js-controller-working.gif" data-lightbox="03-step" data-title="Step 3 - Test of JS Controller for Planning Page">
                        <img src="/kitchen-duty-plugin-for-atlassian-jira/images/doc/step-03-js-controller-working.gif" class="img-thumbnail img-fluid" alt="Step 3 - Test of JS Controller for Planning Page">
                    </a>
                </p>
            </div>
        </div>

        <div class="cs-v-spacer cs-v-spacer--big"></div>

        <h3 class="cs-headline cs-headline--s">Setting up Select2 Widget to find Users</h3>



        

        

        <div class="cs-v-spacer cs-v-spacer--big"></div>
        <div class="cs-v-spacer cs-v-spacer--big"></div>


<!--
        <div class="alert alert-info cs-summary">
            <p><strong>TO BE CONTINUED</strong> - We will continue this tutorial soon.</p>
            <hr class="cs-summary__spacer">
            <p>We will then tend to</p>
            <ul>
                <li><p>Creating REST Resources for UserSearch and KitchenDutyPlanningModel operations.</p></li>
                <li><p>Creating JavaScript Controller and HTML view with Atlassian AUI and interact with REST Resources.</p></li>
            </ul>
            <hr class="cs-summary__spacer">
            <p>Of course there will be more steps following after that. </p>
        </div>



        <div class="cs-v-spacer"></div>
        <div class="cs-tutorial-step-review">
            <div class="cs-tutorial-step-review__headline">
                <strong>You have completed Step 3.</strong> Good Job! You can check out this steps solution on GitHub
            </div>
            <div class="cs-tutorial-step-review__link">
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-03-kitchen-duty-plugin">
                    https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-03-kitchen-duty-plugin
                </a>
            </div>
        </div>

        <div class="cs-v-spacer"></div>
        <p>The graphic shows marked green <strong>which components we implemented in this section</strong>.</p>
        <script>
            var dummyClickCallback = function() {
                toastr.warning('dummy callback', 'Awesome!')
            };
        </script>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-10 col-lg-offset-1 col-xl-8 col-xl-offset-2">
                
    <svg class="cs-interactive-graphic"
         id="p06-ig01"
         data-json-settings="{
                    &quot;markedAsDone&quot;: [ &quot;webwork-action&quot;, &quot;html-view&quot;, &quot;user-resource&quot;, &quot;user-search-resource-model&quot;, &quot;user-js-controller&quot; ],
                    &quot;markedAsTodo&quot;: [ ],
                    &quot;markedAsGrayedOut&quot;: [ ],
                    &quot;onClick&quot;: [ { &quot;webwork-action&quot;: &quot;dummyClickCallback&quot; } ]
                }"
         data-svg-to-load="kitchen-duty-planning-page--component-overview"
         width="100%"
         viewBox="0 0 1043 654"
         preserveAspectRatio="xMaxYMax">
    </svg>

            </div>
        </div>

-->

        <div class="cs-v-spacer cs-v-spacer--big"></div>
        <div class="cs-v-spacer cs-v-spacer--big"></div>

    </div>
</div>



</div>



<div class="cs-footer">
    <div class="cs-footer-left">
        <a class="cs-grey-footer-link" href="/kitchen-duty-plugin-for-atlassian-jira/author-and-license/">Author &amp; License</a> &middot;
        <a class="cs-grey-footer-link" href="/kitchen-duty-plugin-for-atlassian-jira/impressum-and-datenschutz/">Impressum &amp; Datenschutz</a>
        &middot;
        <a class="cs-grey-footer-link" href="/kitchen-duty-plugin-for-atlassian-jira/impressum-and-datenschutz/">Privacy</a>
    </div>
    <div class="cs-footer-right">
        <div class="container-fluid ">
            <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-6 cs-pager cs-page-header--left-fix">
                            <a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/05-step-02-planning-page--user-search-rest-resource/"><i class="fa fa-angle-left"></i> previous page</a>
                        </div>
                        <div class="col-md-6 text-xs-right cs-pager cs-page-header--right-fix">
                            
                                <a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/07-step-04-planning-page--kitchen-duty-planning-rest-resource/">next page <i class="fa fa-angle-right"></i></a>
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>







<script src="/kitchen-duty-plugin-for-atlassian-jira/generated/bundle.js" async></script>



</body>
</html>
